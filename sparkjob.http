
@workspaceId = 
@spark_job_id = 

@accessToken = 

#az account get-access-token --resource https://api.fabric.microsoft.com --query accessToken --output tsv


GET https://api.fabric.microsoft.com/v1/workspaces/{{workspaceId}}/sparkJobDefinitions/{{spark_job_id}}/livySessions
Authorization: Bearer {{accessToken}}
Content-Type: application/json

GET https://api.fabric.microsoft.com/v1/workspaces/{{workspaceId}}/lakehouses/ab88234c-5134-4115-8ff3-e780d45740bd/livyapi/versions/2023-12-01/sessions/f2107d65-b6bd-4eaf-9791-f5b88c85f7ff
Authorization: Bearer {{accessToken}}
Content-Type: application/json




DELETE https://api.fabric.microsoft.com/v1/workspaces/{{workspaceId}}/lakehouses/ab88234c-5134-4115-8ff3-e780d45740bd/livyapi/versions/2023-12-01/sessions/0f6e6334-b1d8-4209-881f-9f121c97f5e8
Authorization: Bearer {{accessToken}}
Content-Type: application/json

GET https://api.fabric.microsoft.com/v1/workspaces/{{workspaceId}}/items
Authorization: Bearer {{accessToken}}
Content-Type: application/json

GET https://api.fabric.microsoft.com/v1/workspaces/{{workspaceId}}/sparkJobDefinitions/{{spark_job_id}}
Authorization: Bearer {{accessToken}}




POST https://api.fabric.microsoft.com/v1/workspaces/{{workspaceId}}/sparkJobDefinitions/{{spark_job_id}}/jobs/instances?jobType=sparkjob
Authorization: Bearer {{accessToken}}


DELETE https://api.fabric.microsoft.com/v1/workspaces/{{workspaceId}}/sparkJobDefinitions/{{spark_job_id}}
Authorization: Bearer {{accessToken}}



POST https://api.fabric.microsoft.com//v1/workspaces/{{workspaceId}}/items
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
    "displayName": "sjd1",
    "type": "SparkJobDefinition",
    "definition": {
        "format": "SparkJobDefinitionV1",
        "parts": [
            {
                "path": "SparkJobDefinitionV1.json",
                "payload":"eyJleGVjdXRhYmxlRmlsZSI6bnVsbCwiZGVmYXVsdExha2Vob3VzZUFydGlmYWN0SWQiOiIiLCJtYWluQ2xhc3MiOiIiLCJhZGRpdGlvbmFsTGFrZWhvdXNlSWRzIjpbXSwicmV0cnlQb2xpY3kiOm51bGwsImNvbW1hbmRMaW5lQXJndW1lbnRzIjoiIiwiYWRkaXRpb25hbExpYnJhcnlVcmlzIjpbXSwibGFuZ3VhZ2UiOiIiLCJlbnZpcm9ubWVudEFydGlmYWN0SWQiOm51bGx9",
                "payloadType": "InlineBase64"
            }
        ]
    }
}


@sjdArtifactId = 399d5d65-6bc2-4e66-b345-58e28e98cb3c
@mainSubFolder = Main

#onelake_access_token=$(az account get-access-token --resource https://storage.azure.com/ --query accessToken -o tsv)
@onelake_access_token = eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IkNOdjBPSTNSd3FsSEZFVm5hb01Bc2hDSDJYRSIsImtpZCI6IkNOdjBPSTNSd3FsSEZFVm5hb01Bc2hDSDJYRSJ9.eyJhdWQiOiJodHRwczovL3N0b3JhZ2UuYXp1cmUuY29tLyIsImlzcyI6Imh0dHBzOi8vc3RzLndpbmRvd3MubmV0LzE1MDMwNWIzLWNjNGItNDZkZC05OTEyLTQyNTY3OGRiMTQ5OC8iLCJpYXQiOjE3NDY2NDc5MjgsIm5iZiI6MTc0NjY0NzkyOCwiZXhwIjoxNzQ2NjUyODc2LCJhY3IiOiIxIiwiYWlvIjoiQVlRQWUvOFpBQUFBSzdCbU9zZWEraGVBUjdqdnA0SkJ0V2JxaEpGckJwQ2ZaSCtUMm0yT2NRM0lyUmJWWWRWeEhKZTRvR1orZ0V2TldkamdIVWpqaE5adkd3M1BhakFXYUZlZzA3aVI0WVlpeVZVWS9HWHRwVU9iK2VlSnJ5ZXcxalJ2RkEvTG9uS0lGc3psZ29YdjJKdjRGbUN5UmJ5QThNYTVMazVGcllMVXQxa1krcmpyL1pJPSIsImFtciI6WyJwd2QiLCJyc2EiLCJtZmEiXSwiYXBwaWQiOiIwNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDYiLCJhcHBpZGFjciI6IjAiLCJkZXZpY2VpZCI6IjVjYjJlZmRhLTIyNmQtNDVmNS1hMzJiLTg4YWM1YTk5NDczZSIsImdyb3VwcyI6WyJjYmIxM2U0MS0yYzFhLTQxYWItYjVhNC04OTQzMmVlNjA4M2IiLCI3Y2E1ZTRlMC0wNDU3LTRiOTgtODRkNS1mZmI2YWJmYjM1MTAiXSwiaWR0eXAiOiJ1c2VyIiwiaXBhZGRyIjoiMTc0LjE2NS41NS4yMzkiLCJuYW1lIjoiYW5pbGR3YSIsIm9pZCI6ImI0N2E0ZTk1LTc4N2UtNGY0OS04MWNkLTdkZWUzNTg0ZTg1NSIsInB1aWQiOiIxMDAzMjAwNDYzMUVERDI5IiwicHdkX3VybCI6Imh0dHBzOi8vcG9ydGFsLm1pY3Jvc29mdG9ubGluZS5jb20vQ2hhbmdlUGFzc3dvcmQuYXNweCIsInJoIjoiMS5BWEVCc3dVREZVdk0zVWFaRWtKV2VOc1VtSUdtQnVUVTg2aENrTGJDc0NsSmV2RnhBWGh4QVEuIiwic2NwIjoidXNlcl9pbXBlcnNvbmF0aW9uIiwic2lkIjoiMDAzMDhkYzktNTUyZC1kYWRkLTZlYTMtZjBmNTU2Y2YyNTViIiwic3ViIjoiejVFUDYxT0xZeS1JWWpEekM4SlE3c2VkRVBlbVVnQXd1M3BSdGZFRDdHNCIsInRpZCI6IjE1MDMwNWIzLWNjNGItNDZkZC05OTEyLTQyNTY3OGRiMTQ5OCIsInVuaXF1ZV9uYW1lIjoiYW5pbGR3YUBNbmdFbnZNQ0FQMzQ3NTQxLm9ubWljcm9zb2Z0LmNvbSIsInVwbiI6ImFuaWxkd2FATW5nRW52TUNBUDM0NzU0MS5vbm1pY3Jvc29mdC5jb20iLCJ1dGkiOiI3VzIxNzFZcmRFUzBnQnBkVi0yREFRIiwidmVyIjoiMS4wIiwieG1zX2lkcmVsIjoiMSAyOCJ9.YE6C8mNwVj0zllC5mrr-S4HNDhsGBvgaQ6lDHS6CFpdtYtQOhNWN_9sA_zck4DCIwDgxeqVc53zqeAPKaaYzb5sdVIl61YQ6GaSclW5h6NZih3my_Jcj3Hhn6rHdkbwSBPAkhqIjYGHsJDGvh-ZBFjPGtmdp-kT-2ctL3dOi8azF4GfmncefCxUXcekH5hzY30hbmDE91B9k6qbQkhFjp10MDPrf1-y2D4MIDZWrgZxmZQ4GJ50pcJkxs1_uIb2hPnR9iqiLiarDal6rDzL448rfZe_XTCjysPQatV5AoT_kU5qSfSaCd_OGNcap9lG2zdjZPvc4BLNI87ZkT7uIXA

@filePath = ./test.py
@fileName = test2.py

PUT https://onelake.dfs.fabric.microsoft.com/{{workspaceId}}/{{sjdArtifactId}}/{{mainSubFolder}}/{{fileName}}?resource=file
Authorization: Bearer {{onelake_access_token}}
x-ms-version: 2020-06-12
Content-Length: 0
Content-Type: application/octet-stream



PATCH https://onelake.dfs.fabric.microsoft.com/{{workspaceId}}/{{sjdArtifactId}}/{{mainSubFolder}}/{{fileName}}?action=append&position=0
Authorization: Bearer {{onelake_access_token}}
x-ms-version: 2020-06-12
Content-Type: text/plain

< ./test.py


PATCH https://onelake.dfs.fabric.microsoft.com/{{workspaceId}}/{{sjdArtifactId}}/{{mainSubFolder}}/{{fileName}}?action=flush&position=3039
Authorization: Bearer {{onelake_access_token}}
x-ms-version: 2020-06-12
Content-Length: 0
Content-Type: text/plain